"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[485],{2485:(G,f,u)=>{u.r(f),u.d(f,{StatsModule:()=>z});var _=u(6895),h=u(864),Z=u(5861),d=u(5439),t=u(4650),T=u(7241),v=u(5830);let y=(()=>{class i{constructor(){this._printStyle=[],this.useExistingCss=!1,this.printDelay=0,this._styleSheetFile=""}set printStyle(e){for(let n in e)e.hasOwnProperty(n)&&this._printStyle.push((n+JSON.stringify(e[n])).replace(/['"]+/g,""));this.returnStyleValues()}returnStyleValues(){return`<style> ${this._printStyle.join(" ").replace(/,/g,";")} </style>`}set styleSheetFile(e){let n=function(r){return`<link rel="stylesheet" type="text/css" href="${r}">`};if(-1!==e.indexOf(",")){const r=e.split(",");for(let a of r)this._styleSheetFile=this._styleSheetFile+n(a)}else this._styleSheetFile=n(e)}returnStyleSheetLinkTags(){return this._styleSheetFile}getElementTag(e){const n=[],r=document.getElementsByTagName(e);for(let a=0;a<r.length;a++)n.push(r[a].outerHTML);return n.join("\r\n")}getFormData(e){for(var n=0;n<e.length;n++)e[n].defaultValue=e[n].value,e[n].checked&&(e[n].defaultChecked=!0)}getHtmlContents(){let e=document.getElementById(this.printSectionId),n=e.getElementsByTagName("input");this.getFormData(n);let r=e.getElementsByTagName("textarea");return this.getFormData(r),e.innerHTML}print(){let e,n,r="",a="";const g=this.getElementTag("base");this.useExistingCss&&(r=this.getElementTag("style"),a=this.getElementTag("link")),e=this.getHtmlContents(),n=window.open("","_blank","top=0,left=0,height=auto,width=auto"),n.document.open(),n.document.write(`\n      <html>\n        <head>\n          <title>${this.printTitle?this.printTitle:""}</title>\n          ${g}\n          ${this.returnStyleValues()}\n          ${this.returnStyleSheetLinkTags()}\n          ${r}\n          ${a}\n        </head>\n        <body>\n          ${e}\n          <script defer>\n            function triggerPrint(event) {\n              window.removeEventListener('load', triggerPrint, false);\n              setTimeout(function() {\n                closeWindow(window.print());\n              }, ${this.printDelay});\n            }\n            function closeWindow(){\n                window.close();\n            }\n            window.addEventListener('load', triggerPrint, false);\n          <\/script>\n        </body>\n      </html>`),n.document.close()}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=t.lG2({type:i,selectors:[["button","ngxPrint",""]],hostBindings:function(e,n){1&e&&t.NdJ("click",function(){return n.print()})},inputs:{useExistingCss:"useExistingCss",printDelay:"printDelay",printStyle:"printStyle",styleSheetFile:"styleSheetFile",printSectionId:"printSectionId",printTitle:"printTitle"}}),i})(),A=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({}),i})();var x=u(8423),m=u(4006);function S(i,s){if(1&i&&(t.TgZ(0,"button",16),t._UZ(1,"i",17),t._uU(2),t.qZA()),2&i){const e=t.oxw();t.Q6J("useExistingCss",!0)("printTitle",e.storename),t.xp6(2),t.hij("",e.util.translate("Print")," ")}}function C(i,s){if(1&i&&(t.TgZ(0,"h2",18),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.util.translate("No Orders Found")," ")}}function q(i,s){1&i&&(t.TgZ(0,"span"),t._uU(1,","),t.qZA())}function w(i,s){if(1&i&&(t.TgZ(0,"p"),t._uU(1),t.YNc(2,q,2,0,"span",34),t.qZA()),2&i){const e=s.$implicit,n=s.index,r=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," "),t.xp6(1),t.Q6J("ngIf",r.orders.length-1!==n)}}function U(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",n.util.currecny," ",e.total," ")}}function Y(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",e.total," ",n.util.currecny,"")}}function F(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",n.util.currecny," ",e.discount," ")}}function N(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",e.discount," ",n.util.currecny,"")}}function M(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",n.util.currecny," ",e.grand_total," ")}}function D(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",e.grand_total," ",n.util.currecny,"")}}function J(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",n.util.currecny," ",n.getCommisions(e.total)," ")}}function E(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.xp6(1),t.AsE("",n.getCommisions(e.total)," ",n.util.currecny,"")}}function I(i,s){if(1&i&&(t.TgZ(0,"tr",35)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t.YNc(6,w,3,2,"p",36),t.qZA(),t.TgZ(7,"td"),t.YNc(8,U,2,2,"span",34),t.YNc(9,Y,2,2,"span",34),t.qZA(),t.TgZ(10,"td"),t.YNc(11,F,2,2,"span",34),t.YNc(12,N,2,2,"span",34),t.qZA(),t.TgZ(13,"td"),t.YNc(14,M,2,2,"span",34),t.YNc(15,D,2,2,"span",34),t.qZA(),t.TgZ(16,"td"),t.YNc(17,J,2,2,"span",34),t.YNc(18,E,2,2,"span",34),t.qZA()()),2&i){const e=s.$implicit,n=t.oxw(2);t.xp6(2),t.hij("##",e.id,""),t.xp6(2),t.Oqu(e.date_time),t.xp6(2),t.Q6J("ngForOf",e.orders),t.xp6(2),t.Q6J("ngIf","left"===n.util.cside),t.xp6(1),t.Q6J("ngIf","right"===n.util.cside),t.xp6(2),t.Q6J("ngIf","left"===n.util.cside),t.xp6(1),t.Q6J("ngIf","right"===n.util.cside),t.xp6(2),t.Q6J("ngIf","left"===n.util.cside),t.xp6(1),t.Q6J("ngIf","right"===n.util.cside),t.xp6(2),t.Q6J("ngIf","left"===n.util.cside),t.xp6(1),t.Q6J("ngIf","right"===n.util.cside)}}function O(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",e.util.currecny," ",e.totalAmount," ")}}function b(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",e.totalAmount," ",e.util.currecny,"")}}function j(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",e.util.currecny," ",e.commisionAmount," ")}}function P(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",e.commisionAmount," ",e.util.currecny,"")}}function Q(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",e.util.currecny," ",e.toPay," ")}}function $(i,s){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.AsE("",e.toPay," ",e.util.currecny,"")}}function H(i,s){if(1&i&&(t.TgZ(0,"div",19)(1,"div",3)(2,"div",4)(3,"div",20)(4,"h3",21),t._uU(5),t.qZA(),t.TgZ(6,"p",22),t._uU(7),t.qZA(),t.TgZ(8,"p",23),t._uU(9),t.qZA(),t.TgZ(10,"p",24),t._uU(11),t._UZ(12,"br"),t._uU(13),t._UZ(14,"br"),t._uU(15),t.qZA(),t.TgZ(16,"p",24),t._uU(17),t.qZA(),t.TgZ(18,"p",24),t._uU(19),t.qZA(),t.TgZ(20,"p",25),t._uU(21),t.qZA(),t.TgZ(22,"p",26),t._uU(23),t.qZA(),t.TgZ(24,"table",27)(25,"thead")(26,"tr",28)(27,"th"),t._uU(28),t.qZA(),t.TgZ(29,"th"),t._uU(30),t.qZA(),t.TgZ(31,"th"),t._uU(32),t.qZA(),t.TgZ(33,"th"),t._uU(34),t.qZA(),t.TgZ(35,"th"),t._uU(36),t.qZA(),t.TgZ(37,"th"),t._uU(38),t.qZA(),t.TgZ(39,"th"),t._uU(40),t.qZA()()(),t.TgZ(41,"tbody"),t.YNc(42,I,19,11,"tr",29),t.qZA()(),t.TgZ(43,"div",30),t._UZ(44,"div",9),t.TgZ(45,"div",31)(46,"p",23),t._uU(47),t.qZA(),t.TgZ(48,"p",23),t._uU(49),t.qZA(),t.TgZ(50,"p",23),t._uU(51),t.qZA()(),t.TgZ(52,"div",32)(53,"p",33),t.YNc(54,O,2,2,"span",34),t.YNc(55,b,2,2,"span",34),t.qZA(),t.TgZ(56,"p",33),t.YNc(57,j,2,2,"span",34),t.YNc(58,P,2,2,"span",34),t.qZA(),t.TgZ(59,"p",33),t.YNc(60,Q,2,2,"span",34),t.YNc(61,$,2,2,"span",34),t.qZA()()()()()()()),2&i){const e=t.oxw();t.xp6(5),t.Oqu(e.util.general.name),t.xp6(2),t.lnq("",e.getDate(e.from)," ",e.util.translate("to")," ",e.getDate(e.to)," "),t.xp6(2),t.hij(" ",e.util.general.name,""),t.xp6(2),t.hij(" ",e.util.general.address," "),t.xp6(2),t.AsE(" ",e.util.general.city," ",e.util.general.state,""),t.xp6(2),t.AsE(" ",e.util.general.country," ",e.util.general.zip," "),t.xp6(2),t.hij(" ",e.util.general.email,""),t.xp6(2),t.hij(" ",e.util.general.mobile," "),t.xp6(2),t.hij(" ",e.util.store.name," "),t.xp6(2),t.Oqu(e.today()),t.xp6(5),t.hij("",e.util.translate("Id")," "),t.xp6(2),t.hij("",e.util.translate("Ordered on")," "),t.xp6(2),t.hij("",e.util.translate("Items")," "),t.xp6(2),t.hij("",e.util.translate("Total")," "),t.xp6(2),t.hij("",e.util.translate("Discount")," "),t.xp6(2),t.hij("",e.util.translate("Grand Total")," "),t.xp6(2),t.hij("",e.util.translate("Commission")," "),t.xp6(2),t.Q6J("ngForOf",e.storeOrder),t.xp6(5),t.hij(" ",e.util.translate("Total")," "),t.xp6(2),t.hij(" ",e.util.translate("Commission")," "),t.xp6(2),t.hij(" ",e.util.translate("Amount Pay")," "),t.xp6(3),t.Q6J("ngIf","left"===e.util.cside),t.xp6(1),t.Q6J("ngIf","right"===e.util.cside),t.xp6(2),t.Q6J("ngIf","left"===e.util.cside),t.xp6(1),t.Q6J("ngIf","right"===e.util.cside),t.xp6(2),t.Q6J("ngIf","left"===e.util.cside),t.xp6(1),t.Q6J("ngIf","right"===e.util.cside)}}const k=[{path:"",component:(()=>{class i{constructor(e,n){this.util=e,this.api=n,this.stores=[],this.allOrders=[],this.storeOrder=[],this.totalAmount=0,this.commisionAmount=0,this.toPay=0,this.totalAmountsFromOrder=0,this.storeId=parseInt(localStorage.getItem("uid")??"0")}ngOnInit(){}getStats(){var e=this;if(console.log("from",this.from),console.log("to",this.to),!this.from||!this.to)return console.log("not valid"),this.util.error(this.util.translate("All Fields are required")),!1;{console.log("ok");const n={id:localStorage.getItem("uid"),from:d(this.from,"YYYY-MM-DD HH:mm A").utc(!1).format("YYYY-MM-DD HH:mm"),to:d(this.to,"YYYY-MM-DD HH:mm A").utc(!1).format("YYYY-MM-DD HH:mm")};console.log(n),this.util.show(),this.apiCalled=!1,this.storeOrder=[],this.api.post_private("v1/orders/getStoreStatsDataWithDates",n).then(r=>{if(this.apiCalled=!0,this.util.hide(),console.log(r),r&&200==r.status&&r.data.length){this.storecommission=r.commission.commission,console.log("commustion",this.storecommission);let a=0;r.data.forEach(function(){var g=(0,Z.Z)(function*(l){if((p=>{try{return JSON.parse(p),!0}catch{return!1}})(l.orders)&&(l.orders=JSON.parse(l.orders),l.date_time=d(l.date_time).format("dddd, MMMM Do YYYY"),l.orders=yield l.orders.filter(p=>p.store_id==e.storeId),console.log(l.discount),(p=>{try{return JSON.parse(p),!0}catch{return!1}})(l.status))){const c=yield JSON.parse(l.status).filter(o=>o.id==e.storeId);c&&c.length&&"delivered"==c[0].status&&(yield l.orders.forEach(o=>{o.variations&&""!==o.variations&&"string"==typeof o.variations&&(o.variations=JSON.parse(o.variations),console.log(o.variant),null==o.variant&&(o.variant=0)),a+=o&&0==o.discount?1==o.size||1==o.size?o.variations[0].calc[o.variant].discount&&0!==o.variations[0].items[o.variant].discount?parseFloat(o.variations[0].items[o.variant].discount)*o.quantity:parseFloat(o.variations[0].items[o.variant].price)*o.quantity:parseFloat(o.original_price)*o.quantity:1==o.size||1==o.size?o.variations[0].items[o.variant].discount&&0!==o.variations[0].items[o.variant].discount?parseFloat(o.variations[0].items[o.variant].discount)*o.quantity:parseFloat(o.variations[0].items[o.variant].price)*o.quantity:parseFloat(o.sell_price)*o.quantity}),e.storeOrder.push(l))}});return function(l){return g.apply(this,arguments)}}()),setTimeout(()=>{console.log(this.storeOrder),console.log(a,this.storecommission);const l=function g(p,c){return p/100*c}(a,parseFloat(this.storecommission));console.log("commistion====>>>>>",l.toFixed(2)),this.commisionAmount=l.toFixed(2),this.totalAmount=a,this.toPay=this.commisionAmount},1e3)}},r=>{this.util.hide(),console.log(r),this.apiCalled=!0,this.util.error(this.util.translate("Something went wrong"))}).catch(r=>{this.util.hide(),console.log(r),this.apiCalled=!0,this.util.error(this.util.translate("Something went wrong"))})}}getCommisions(e){return(parseFloat(e)*this.storecommission/100).toFixed(2)}donwloadPDF(){}today(){return d().format("ll")}getDate(e){return d(e).format("ll")}getName(){return this.storeOrder[0].name+"_"+d(this.from).format("DDMMYYYY")+"_"+d(this.to).format("DDMMYYYY")}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.f),t.Y36(v.s))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-stats"]],decls:31,vars:12,consts:[["type","ball-scale-multiple"],[1,"animated","fadeIn"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-body","reset-table","p-t-0"],[1,"form-group","row"],[1,"col-sm-6"],["type","date",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"col-sm-12"],[1,"btn","btn-danger","btn-round",3,"click"],["style","margin-left: 20px;","printSectionId","print-section","ngxPrint","","class","btn btn-primary",3,"useExistingCss","printTitle",4,"ngIf"],["style","text-align: center;",4,"ngIf"],["class","row","id","print-section",4,"ngIf"],["printSectionId","print-section","ngxPrint","",1,"btn","btn-primary",2,"margin-left","20px",3,"useExistingCss","printTitle"],[1,"icofont","icofont-printer"],[2,"text-align","center"],["id","print-section",1,"row"],[1,"card-body",2,"padding","20px"],[2,"text-align","center","color","#7ec6aa"],[2,"text-align","center","color","#ED7669"],[2,"text-align","right","font-weight","bold","margin","0px !important","color","#7EC6AA"],[2,"text-align","right","font-weight","bold","margin","0px !important"],[2,"text-align","left","font-weight","bold","margin","0px","color","#aaafad"],[2,"text-align","left","font-weight","bold","color","#7EC6AA"],[1,"table","table-striped"],[1,"text-uppercase",2,"color","#7ec6aa"],["style","background-color: #F5F8FA;",4,"ngFor","ngForOf"],[1,"row",2,"padding","20px"],[1,"col-sm-4"],[1,"col-sm-2"],[2,"color","black !important","margin","0px !important","text-align","right"],[4,"ngIf"],[2,"background-color","#F5F8FA"],[4,"ngFor","ngForOf"]],template:function(e,n){1&e&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._uU(6),t.qZA(),t.TgZ(7,"div",6)(8,"div",2)(9,"div",3)(10,"div",4)(11,"div",6)(12,"h5"),t._uU(13),t.qZA()(),t.TgZ(14,"div",7)(15,"div",8)(16,"div",9)(17,"label"),t._uU(18),t.qZA(),t.TgZ(19,"input",10),t.NdJ("ngModelChange",function(a){return n.from=a}),t.qZA()(),t.TgZ(20,"div",9)(21,"label"),t._uU(22),t.qZA(),t.TgZ(23,"input",10),t.NdJ("ngModelChange",function(a){return n.to=a}),t.qZA()()(),t.TgZ(24,"div",8)(25,"div",11)(26,"button",12),t.NdJ("click",function(){return n.getStats()}),t._uU(27),t.qZA(),t.YNc(28,S,3,3,"button",13),t.qZA()()()()()(),t.YNc(29,C,2,1,"h2",14),t.YNc(30,H,62,31,"div",15),t.qZA()()()()()),2&e&&(t.xp6(6),t.hij(" ",n.util.translate("Stats")," "),t.xp6(7),t.hij("",n.util.translate("Get Stats")," "),t.xp6(5),t.hij("",n.util.translate("From Date")," "),t.xp6(1),t.Q6J("ngModel",n.from)("placeholder",n.util.translate("From Date")),t.xp6(3),t.hij("",n.util.translate("To Date")," "),t.xp6(1),t.Q6J("ngModel",n.to)("placeholder",n.util.translate("To Date")),t.xp6(4),t.hij("",n.util.translate("Get Stats")," "),t.xp6(1),t.Q6J("ngIf",n.from&&n.to&&(null==n.storeOrder?null:n.storeOrder.length)),t.xp6(1),t.Q6J("ngIf",n.from&&n.to&&!(null!=n.storeOrder&&n.storeOrder.length)&&n.apiCalled),t.xp6(1),t.Q6J("ngIf",n.from&&n.to&&(null==n.storeOrder?null:n.storeOrder.length)))},dependencies:[_.sg,_.O5,y,x.Ro,m.Fj,m.JJ,m.On],styles:['@charset "UTF-8";p[_ngcontent-%COMP%]{margin:0!important}']}),i})()}];let B=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[h.Bz.forChild(k),h.Bz]}),i})(),z=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[_.ez,B,A,x.ef,m.u5]}),i})()}}]);