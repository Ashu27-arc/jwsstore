"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[368],{2368:(H,d,l)=>{l.r(d),l.d(d,{ForgotModule:()=>Q});var c=l(6895),_=l(864),f=l(5226),p=l.n(f),g=l(4322),t=l(4650),T=l(5830),x=l(7241),h=l(685),u=l(4006),m=l(8423);const a=function(){return{standalone:!0}};function w(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",15)(1,"p"),t._uU(2),t.qZA(),t.TgZ(3,"input",16),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.otp=s)}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.hij("",e.util.translate("Enter OTP")," "),t.xp6(1),t.Tol(1==e.submited&&""==e.otp?"validator_error":""),t.Q6J("placeholder",e.util.translate("Enter OTP"))("ngModel",e.otp)("ngModelOptions",t.DdM(6,a))}}function v(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.goToTabs())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.util.translate("Send OTP"))}}function C(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.verifyOTP())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.util.translate("Verify OTP"))}}function M(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form")(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"p",9),t._uU(4),t.qZA(),t.TgZ(5,"div",10)(6,"input",11),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.email=s)}),t.qZA()(),t.YNc(7,w,4,7,"div",12),t.TgZ(8,"div",3)(9,"div",13),t.YNc(10,v,2,1,"button",14),t.YNc(11,C,2,1,"button",14),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.util.translate("Reset Password")),t.xp6(2),t.Oqu(e.util.translate("Send OTP")),t.xp6(2),t.Q6J("ngModel",e.email)("placeholder",e.util.translate("Email address"))("ngModelOptions",t.DdM(8,a)),t.xp6(1),t.Q6J("ngIf",1==e.otpSent),t.xp6(3),t.Q6J("ngIf",0==e.otpSent),t.xp6(1),t.Q6J("ngIf",1==e.otpSent)}}function F(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form")(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"p",9),t._uU(4),t.qZA(),t.TgZ(5,"div",18)(6,"input",19),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.password=s)}),t.qZA()(),t.TgZ(7,"div",18)(8,"input",19),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.confirm=s)}),t.qZA()(),t.TgZ(9,"div",3)(10,"div",13)(11,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.updatePassword())}),t._uU(12),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.util.translate("Reset Password")),t.xp6(2),t.Oqu(e.util.translate("Update Password")),t.xp6(2),t.Q6J("ngModel",e.password)("placeholder",e.util.translate("Password"))("ngModelOptions",t.DdM(9,a)),t.xp6(2),t.Q6J("ngModel",e.confirm)("placeholder",e.util.translate("Confirm Password"))("ngModelOptions",t.DdM(10,a)),t.xp6(4),t.Oqu(e.util.translate("Update"))}}function b(i,n){if(1&i&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&i){const e=n.$implicit;t.Q6J("value",e.dialling_code),t.xp6(1),t.hij(" ",e.country_name," ")}}function P(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"select",23),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.country_code=s)}),t.YNc(2,b,2,2,"option",24),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.country_code)("ngModelOptions",t.DdM(3,a)),t.xp6(1),t.Q6J("ngForOf",e.util.countrys)}}function y(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"input",26),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.country_code=s)}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngModel",e.country_code)("placeholder",e.util.translate("Country Code"))("disabled",!0)("ngModelOptions",t.DdM(4,a))}}function O(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",15)(1,"p"),t._uU(2,"Enter OTP"),t.qZA(),t.TgZ(3,"input",16),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw(2);return t.KtG(r.otp=s)}),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(3),t.Tol(1==e.submited&&""==e.otp?"validator_error":""),t.Q6J("placeholder",e.util.translate("Enter OTP"))("ngModel",e.otp)("ngModelOptions",t.DdM(5,a))}}function Z(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.sendPhoneOTP())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.util.translate("Send OTP"))}}function J(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return t.KtG(s.verifyOTP())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.Oqu(e.util.translate("Verify OTP"))}}function q(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form")(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"p",9),t._uU(4),t.qZA(),t.TgZ(5,"div",3)(6,"div",20),t.YNc(7,P,3,4,"div",8),t.YNc(8,y,2,5,"div",8),t.qZA(),t.TgZ(9,"div",21)(10,"div",10)(11,"input",22),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.mobile=s)}),t.qZA()()()(),t.YNc(12,O,4,6,"div",12),t.TgZ(13,"div",3)(14,"div",13),t.YNc(15,Z,2,1,"button",14),t.YNc(16,J,2,1,"button",14),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.util.translate("Reset Password")),t.xp6(2),t.Oqu(e.util.translate("Send OTP")),t.xp6(3),t.Q6J("ngIf",null==e.util.countrys?null:e.util.countrys.length),t.xp6(1),t.Q6J("ngIf",!(null!=e.util.countrys&&e.util.countrys.length)),t.xp6(3),t.Q6J("ngModel",e.mobile)("placeholder",e.util.translate("Phone"))("ngModelOptions",t.DdM(10,a)),t.xp6(1),t.Q6J("ngIf",1==e.otpSent),t.xp6(3),t.Q6J("ngIf",0==e.otpSent),t.xp6(1),t.Q6J("ngIf",1==e.otpSent)}}function A(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"form")(1,"h1"),t._uU(2),t.qZA(),t.TgZ(3,"p",9),t._uU(4),t.qZA(),t.TgZ(5,"div",18)(6,"input",19),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.password=s)}),t.qZA()(),t.TgZ(7,"div",18)(8,"input",19),t.NdJ("ngModelChange",function(s){t.CHM(e);const r=t.oxw();return t.KtG(r.confirm=s)}),t.qZA()(),t.TgZ(9,"div",3)(10,"div",13)(11,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.updatePassword())}),t._uU(12),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.util.translate("Reset Password")),t.xp6(2),t.Oqu(e.util.translate("Update Password")),t.xp6(2),t.Q6J("ngModel",e.password)("placeholder",e.util.translate("Password"))("ngModelOptions",t.DdM(9,a)),t.xp6(2),t.Q6J("ngModel",e.confirm)("placeholder",e.util.translate("Confirm Password"))("ngModelOptions",t.DdM(10,a)),t.xp6(4),t.Oqu(e.util.translate("Update"))}}const N=[{path:"",component:(()=>{class i{constructor(e,o,s){this.api=e,this.util=o,this.location=s,this.div=1,this.otp_id="",this.email="",this.otpSent=!1,this.otp="",this.password="",this.confirm="",this.temp="",this.country_code="",this.mobile="",setTimeout(()=>{this.country_code=this.util.default_country_code},1e3)}ngOnInit(){setTimeout(()=>{this.recaptchaVerifier=new g.lI("sign-in-button",{size:"invisible",callback:()=>{},"expired-callback":()=>{}},g.v0())},5e3)}onOtpChange(e){console.log(e),this.otp=e}goToTabs(){if(!/^[\w._-]+[+]?[\w._-]+@[\w.-]+\.[a-zA-Z]{2,6}$/.test(this.email))return this.util.error(this.util.translate("Please enter valid email")),!1;console.log("login"),this.util.show(),this.api.post_public("v1/auth/verifyEmailForReset",{email:this.email}).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200===o.status&&!0===o.data&&o.otp_id?(this.otpSent=!0,this.otp_id=o.otp_id):o&&o.status&&500===o.status&&!1===o.data&&this.util.error(o.message)},o=>{this.util.hide(),this.util.apiErrorHandler(o)}).catch(o=>{this.util.hide(),console.log(o),this.util.apiErrorHandler(o)})}goToBack(){this.location.back()}sendPhoneOTP(){if("2"==this.util.smsGateway){const e={country_code:"+"+this.country_code,mobile:this.mobile};this.util.show(),this.api.post_public("v1/auth/verifyPhoneForFirebase",e).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200==o.status&&o.data&&(console.log("open firebase web version"),this.util.show(),this.api.signInWithPhoneNumber(this.recaptchaVerifier,e.country_code+e.mobile).then(s=>{this.util.hide(),this.otpSent=!0}).catch(s=>{this.util.hide(),console.log(s),this.util.error(s)}))},o=>{this.util.hide(),this.util.apiErrorHandler(o)}).catch(o=>{this.util.hide(),console.log(o),this.util.apiErrorHandler(o)})}else this.util.show(),this.api.post_public("v1/otp/verifyPhone",{country_code:"+"+this.country_code,mobile:this.mobile}).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200==o.status&&1==o.data&&o.otp_id?(this.otp_id=o.otp_id,this.otpSent=!0):o&&o.status&&500==o.status&&0==o.data&&this.util.error(this.util.translate("Something went wrong"))},o=>{this.util.hide(),this.util.apiErrorHandler(o)}).catch(o=>{this.util.hide(),console.log(o),this.util.apiErrorHandler(o)})}verifyOTP(){if(""==this.otp||null==this.otp||!this.otp)return this.util.error("OTP is required"),!1;console.log(this.otp_id,this.otp,this.util.reset_pwd),0==this.util.reset_pwd?this.verifyEmailOTP():"2"==this.util.smsGateway&&1==this.util.reset_pwd?this.verifyFirebaseOTP():1==this.util.reset_pwd&&"2"!=this.util.smsGateway&&this.verifyPhoneOTP()}verifyEmailOTP(){const e={id:this.otp_id,otp:this.otp,type:"email",email:this.email,country_code:"NA",mobile:"NA"};this.util.show(),this.api.post_public("v1/otp/verifyOTPReset",e).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200===o.status&&o.data&&(this.div=2,this.temp=o.temp,console.log("temp token",this.temp))},o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}verifyFirebaseOTP(){this.util.show(),this.api.enterVerificationCode(this.otp).then(e=>{this.util.hide(),this.generateTokenFromCreds(),console.log(e)}).catch(e=>{console.log(e),this.util.hide(),this.util.error(e)})}generateTokenFromCreds(){this.util.show(),this.api.post_public("v1/otp/generateTempToken",{country_code:"+"+this.country_code,mobile:this.mobile}).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200==o.status&&(this.div=2,this.temp=o.temp,console.log("temp token",this.temp))},o=>{this.util.hide(),this.util.apiErrorHandler(o)}).catch(o=>{this.util.hide(),console.log(o),this.util.apiErrorHandler(o)})}verifyPhoneOTP(){const e={id:this.otp_id,otp:this.otp,type:"phone",email:"NA",country_code:"+"+this.country_code,mobile:this.mobile};this.util.show(),this.api.post_public("v1/otp/verifyOTPReset",e).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200===o.status&&o.data&&(this.div=2,this.temp=o.temp,console.log("temp token",this.temp))},o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}updatePassword(){return""!=this.password&&null!=this.password&&this.password&&""!=this.confirm&&null!=this.confirm&&this.confirm?this.password!=this.confirm?(this.util.error(this.util.translate("Password does not match")),!1):(console.log("update"),void(0==this.util.reset_pwd?this.updatePasswordWithEmail():"2"==this.util.smsGateway&&1==this.util.reset_pwd?this.updatePasswordFromFirebase():1==this.util.reset_pwd&&"2"!=this.util.smsGateway&&this.updatePasswordWithPhone())):(this.util.error("Password is required"),!1)}updatePasswordWithEmail(){const e={id:this.otp_id,email:this.email,password:this.password};this.util.show(),this.api.post_temp("v1/password/updateUserPasswordWithEmail",e,this.temp).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200===o.status&&o.data&&(p().fire({position:"top-end",icon:"success",title:this.util.translate("Password Updated"),showConfirmButton:!1,timer:1500}),this.location.back())},o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}updatePasswordFromFirebase(){this.api.post_temp("v1/password/updatePasswordFromFirebase",{country_code:"+"+this.country_code,mobile:this.mobile,password:this.password},this.temp).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200===o.status&&o.data&&(p().fire({position:"top-end",icon:"success",title:this.util.translate("Password Updated"),showConfirmButton:!1,timer:1500}),this.location.back())},o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}updatePasswordWithPhone(){this.api.post_temp("v1/password/updateUserPasswordWithPhone",{id:this.otp_id,country_code:"+"+this.country_code,mobile:this.mobile,password:this.password,key:"+"+this.country_code+this.mobile},this.temp).then(o=>{console.log(o),this.util.hide(),o&&o.status&&200===o.status&&o.data&&(p().fire({position:"top-end",icon:"success",title:this.util.translate("Password Updated"),showConfirmButton:!1,timer:1500}),this.location.back())},o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP"))))).catch(o=>(this.util.hide(),console.log(o),o&&401===o.status&&o.error.error||o&&500===o.status&&o.error.error?(this.util.error(o.error.error),!1):(this.util.hide(),void this.util.error(this.util.translate("Wrong OTP")))))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.s),t.Y36(x.f),t.Y36(c.Ye))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-forgot"]],decls:13,vars:4,consts:[["type","ball-scale-multiple"],["id","sign-in-button"],[1,"bg-light","min-vh-100","d-flex","flex-row","align-items-center"],[1,"row"],[1,"col-md-6","mx-auto"],[1,"card-group"],[1,"card","p-4"],[1,"card-body"],[4,"ngIf"],[1,"text-muted"],[1,"input-group","mb-3"],["type","email","autocomplete","email","required","",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],["class","otp_content",4,"ngIf"],[1,"col-6"],["type","button","class","btn btn-primary px-4",3,"click",4,"ngIf"],[1,"otp_content"],["cFormControl","","type","number",3,"placeholder","ngModel","ngModelOptions","ngModelChange"],["type","button",1,"btn","btn-primary","px-4",3,"click"],[1,"input-group","mb-4"],["type","password","autocomplete","current-password","required","",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],[1,"col-3"],[1,"col-9"],["type","number","autocomplete","phone","required","",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],["id","ccmonth",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","tel","autocomplete","phone","required","",1,"form-control",3,"ngModel","placeholder","disabled","ngModelOptions","ngModelChange"]],template:function(e,o){1&e&&(t._UZ(0,"ngx-spinner",0)(1,"div",1),t.TgZ(2,"div",2)(3,"c-container")(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),t.YNc(9,M,12,9,"form",8),t.YNc(10,F,13,11,"form",8),t.YNc(11,q,17,11,"form",8),t.YNc(12,A,13,11,"form",8),t.qZA()()()()()()()),2&e&&(t.xp6(9),t.Q6J("ngIf",0==o.util.reset_pwd&&1==o.div),t.xp6(1),t.Q6J("ngIf",0==o.util.reset_pwd&&2==o.div),t.xp6(1),t.Q6J("ngIf",1==o.util.reset_pwd&&1==o.div),t.xp6(1),t.Q6J("ngIf",1==o.util.reset_pwd&&2==o.div))},dependencies:[c.sg,c.O5,h.e$z,h.oHf,u._Y,u.YN,u.Kr,u.Fj,u.wV,u.EJ,u.JJ,u.JL,u.Q7,u.On,u.F,m.Ro],styles:['@charset "UTF-8";']}),i})()}];let E=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[_.Bz.forChild(N),_.Bz]}),i})();var U=l(1334);let Q=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.ez,E,h.dTQ,h.hJ1,h.zE6,U.QX,h.ejP,u.u5,m.ef]}),i})()}}]);