"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[522],{3522:(xt,h,l)=>{l.r(h),l.d(h,{OrderDetailsModule:()=>ht});var g=l(6895),f=l(9455),x=l(5439),t=l(4650),m=l(7241),O=l(5830),p=l(4006),v=l(8423);function C(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",11)(1,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.printOrder())}),t._uU(2),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(2),t.hij("",n.util.translate("Print")," ")}}function y(e,s){if(1&e&&(t.TgZ(0,"div",13)(1,"div",14),t._uU(2),t.qZA()()),2&e){const n=t.oxw();t.xp6(2),t.hij("",n.util.translate("Loading...")," ")}}const M=function(e){return{"background-image":e}};function P(e,s){if(1&e&&(t.TgZ(0,"div",30)(1,"div",31),t._UZ(2,"div",32),t.TgZ(3,"div",33)(4,"p",34),t._uU(5),t.qZA(),t.TgZ(6,"p",35),t._uU(7),t.qZA()()()()),2&e){const n=t.oxw(2);t.xp6(2),t.Q6J("ngStyle",t.VKq(4,M,"url("+n.api.mediaURL+n.userInfo.cover+"),url(assets/imgs/user.png)")),t.xp6(3),t.AsE("",n.userInfo.first_name," ",n.userInfo.last_name," "),t.xp6(2),t.Oqu(n.datetime)}}function T(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",n.gram," ",o.util.translate("grams")," ")}}function Z(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",n.kg," ",o.util.translate("kg")," ")}}function w(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",n.liter," ",o.util.translate("ltr")," ")}}function A(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",n.ml," ",o.util.translate("ml")," ")}}function D(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",n.pcs," ",o.util.translate("pcs")," ")}}function b(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",o.util.currecny," ",0==n.discount?n.original_price:n.sell_price," ")}}function I(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",0==n.discount?n.original_price:n.sell_price," ",o.util.currecny," ")}}function N(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,T,2,2,"span",39),t.YNc(3,Z,2,2,"span",39),t.YNc(4,w,2,2,"span",39),t.YNc(5,A,2,2,"span",39),t.YNc(6,D,2,2,"span",39),t.YNc(7,b,2,2,"span",39),t.YNc(8,I,2,2,"span",39),t.qZA()),2&e){const n=t.oxw().$implicit,o=t.oxw(3);t.xp6(1),t.hij("",n.name," - "),t.xp6(1),t.Q6J("ngIf",1==n.have_gram),t.xp6(1),t.Q6J("ngIf",1==n.have_kg),t.xp6(1),t.Q6J("ngIf",1==n.have_liter),t.xp6(1),t.Q6J("ngIf",1==n.have_ml),t.xp6(1),t.Q6J("ngIf",1==n.have_pcs),t.xp6(1),t.Q6J("ngIf","left"==o.util.cside),t.xp6(1),t.Q6J("ngIf","right"==o.util.cside)}}function k(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",o.util.currecny," ",0==n.discount?n.original_price:n.sell_price," ")}}function q(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2).$implicit,o=t.oxw(3);t.xp6(1),t.AsE(" ",0==n.discount?n.original_price:n.sell_price," ",o.util.currecny," ")}}function U(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.YNc(4,k,2,2,"span",39),t.YNc(5,q,2,2,"span",39),t.qZA()),2&e){const n=t.oxw().$implicit,o=t.oxw(3);t.xp6(1),t.hij(" ",n.name," - "),t.xp6(2),t.hij(" ",n.variations[0].items[n.variant].title," "),t.xp6(1),t.Q6J("ngIf","left"==o.util.cside),t.xp6(1),t.Q6J("ngIf","right"==o.util.cside)}}function J(e,s){if(1&e&&(t.TgZ(0,"p",42),t.YNc(1,N,9,8,"span",39),t.YNc(2,U,6,4,"span",39),t.TgZ(3,"span"),t._uU(4),t.qZA()()),2&e){const n=s.$implicit;t.xp6(1),t.Q6J("ngIf",0==n.size),t.xp6(1),t.Q6J("ngIf",1==n.size),t.xp6(2),t.hij("X ",n.quantity,"")}}function E(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.util.currecny," ",n.orderTotal," ")}}function Y(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.orderTotal," ",n.util.currecny," ")}}function S(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.util.currecny," ",n.orderDeliveryCharge," ")}}function j(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.orderDeliveryCharge," ",n.util.currecny," ")}}function Q(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",n.util.translate("Split Order Tax")," ")}}function R(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",n.util.translate("Order Tax")," ")}}function F(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.util.currecny," ",n.orderTaxCharge," ")}}function z(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.orderTaxCharge," ",n.util.currecny," ")}}function H(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",n.util.translate("Split Order Discount")," ")}}function $(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",n.util.translate("Order Discount")," ")}}function B(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" - ",n.util.currecny," ",n.orderDiscount," ")}}function K(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" - ",n.orderDiscount," ",n.util.currecny," ")}}function W(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",n.util.translate("Split Order Wallet Discount")," ")}}function G(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij(" ",n.util.translate("Order Wallet Discount")," ")}}function L(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" - ",n.util.currecny," ",n.orderWalletDiscount," ")}}function X(e,s){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" - ",n.orderWalletDiscount," ",n.util.currecny," ")}}function V(e,s){if(1&e&&(t.TgZ(0,"span",40),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.util.currecny," ",n.getTotalBilling()," ")}}function tt(e,s){if(1&e&&(t.TgZ(0,"span",40),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.AsE(" ",n.getTotalBilling()," ",n.util.currecny," ")}}function nt(e,s){if(1&e&&(t.TgZ(0,"div",36),t.YNc(1,J,5,3,"p",37),t.TgZ(2,"p",38)(3,"span"),t._uU(4),t.qZA(),t.YNc(5,E,2,2,"span",39),t.YNc(6,Y,2,2,"span",39),t.qZA(),t.TgZ(7,"p",38)(8,"span"),t._uU(9),t.qZA(),t.YNc(10,S,2,2,"span",39),t.YNc(11,j,2,2,"span",39),t.qZA(),t.TgZ(12,"p",38),t.YNc(13,Q,2,1,"span",39),t.YNc(14,R,2,1,"span",39),t.YNc(15,F,2,2,"span",39),t.YNc(16,z,2,2,"span",39),t.qZA(),t.TgZ(17,"p",38),t.YNc(18,H,2,1,"span",39),t.YNc(19,$,2,1,"span",39),t.YNc(20,B,2,2,"span",39),t.YNc(21,K,2,2,"span",39),t.qZA(),t.TgZ(22,"p",38),t.YNc(23,W,2,1,"span",39),t.YNc(24,G,2,1,"span",39),t.YNc(25,L,2,2,"span",39),t.YNc(26,X,2,2,"span",39),t.qZA(),t.TgZ(27,"p",38)(28,"span",40),t._uU(29),t.qZA(),t.YNc(30,V,2,2,"span",41),t.YNc(31,tt,2,2,"span",41),t.qZA()()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n.orders),t.xp6(3),t.hij(" ",n.util.translate("Order Item Total")," "),t.xp6(1),t.Q6J("ngIf","left"==n.util.cside),t.xp6(1),t.Q6J("ngIf","right"==n.util.cside),t.xp6(3),t.hij(" ",n.util.translate("Order Delivery Charge")," "),t.xp6(1),t.Q6J("ngIf","left"==n.util.cside),t.xp6(1),t.Q6J("ngIf","right"==n.util.cside),t.xp6(2),t.Q6J("ngIf",n.totalStores>1),t.xp6(1),t.Q6J("ngIf",1==n.totalStores),t.xp6(1),t.Q6J("ngIf","left"==n.util.cside),t.xp6(1),t.Q6J("ngIf","right"==n.util.cside),t.xp6(2),t.Q6J("ngIf",n.totalStores>1),t.xp6(1),t.Q6J("ngIf",1==n.totalStores),t.xp6(1),t.Q6J("ngIf","left"==n.util.cside),t.xp6(1),t.Q6J("ngIf","right"==n.util.cside),t.xp6(2),t.Q6J("ngIf",n.totalStores>1),t.xp6(1),t.Q6J("ngIf",1==n.totalStores),t.xp6(1),t.Q6J("ngIf","left"==n.util.cside),t.xp6(1),t.Q6J("ngIf","right"==n.util.cside),t.xp6(3),t.hij(" ",n.util.translate("Amount to Collect")," "),t.xp6(1),t.Q6J("ngIf","left"==n.util.cside),t.xp6(1),t.Q6J("ngIf","right"==n.util.cside)}}function et(e,s){if(1&e&&(t.TgZ(0,"div",20)(1,"p",21),t._UZ(2,"i",43),t._uU(3),t.qZA()()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" ",n.address," ")}}function it(e,s){1&e&&t._UZ(0,"div",44)}function ot(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",45)(1,"div",46)(2,"div",47),t._UZ(3,"i",48),t._uU(4," \xa0\xa0 "),t.TgZ(5,"p",34),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.call())}),t._uU(9),t.qZA()()()()}if(2&e){const n=t.oxw(2);t.xp6(6),t.Oqu(n.userInfo.mobile),t.xp6(3),t.hij("",n.util.translate("Call")," ")}}function st(e,s){1&e&&t._UZ(0,"div",44)}function rt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",45)(1,"div",46)(2,"div",47),t._UZ(3,"i",49),t._uU(4,"\xa0\xa0 "),t.TgZ(5,"p",34),t._uU(6),t.qZA()(),t.TgZ(7,"div")(8,"button",12),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.email())}),t._uU(9),t.qZA()()()()}if(2&e){const n=t.oxw(2);t.xp6(6),t.Oqu(n.userInfo.email),t.xp6(3),t.hij("",n.util.translate("Email")," ")}}function at(e,s){1&e&&t._UZ(0,"i",53)}function ct(e,s){if(1&e&&(t.TgZ(0,"span",50),t._UZ(1,"div",51),t.YNc(2,at,1,0,"i",52),t.qZA()),2&e){const n=s.$implicit;t.xp6(1),t.ekj("line_div_darkgray",1==n.status),t.xp6(1),t.Q6J("ngIf",1==n.status)}}function dt(e,s){if(1&e&&(t.TgZ(0,"span")(1,"div",51)(2,"p"),t._uU(3),t.qZA()(),t.TgZ(4,"div",54),t._uU(5),t.qZA()()),2&e){const n=s.$implicit;t.xp6(2),t.ekj("round_div_red",1==n.status)("round_div_darkgray",1==n.status),t.xp6(1),t.hij(" ",n.time,""),t.xp6(1),t.ekj("round_div_red",1==n.status)("round_div_darkgray",1==n.status),t.xp6(1),t.hij(" ",n.value," ")}}function lt(e,s){if(1&e&&(t.TgZ(0,"div",15),t.YNc(1,P,8,6,"div",16),t.TgZ(2,"p",17),t._uU(3),t.qZA(),t.TgZ(4,"div",18),t.YNc(5,nt,32,22,"div",19),t.qZA(),t.TgZ(6,"div",20)(7,"p"),t._uU(8),t.qZA(),t.TgZ(9,"p",21),t._uU(10),t.qZA()(),t.YNc(11,et,4,1,"div",22),t.TgZ(12,"p",17),t._uU(13),t.qZA(),t.TgZ(14,"div",20)(15,"p"),t._uU(16),t.qZA(),t.TgZ(17,"p",21),t._uU(18),t.qZA()(),t.TgZ(19,"div",20)(20,"p"),t._uU(21),t.qZA(),t.TgZ(22,"p",21),t._uU(23),t.qZA()(),t.TgZ(24,"div",20)(25,"p"),t._uU(26),t.qZA(),t.TgZ(27,"p",21),t._uU(28),t.qZA()(),t.YNc(29,it,1,0,"div",23),t.YNc(30,ot,10,2,"div",24),t.YNc(31,st,1,0,"div",23),t.YNc(32,rt,10,2,"div",24),t.TgZ(33,"p",17),t._uU(34),t.qZA(),t.TgZ(35,"div",25)(36,"div",26),t.YNc(37,ct,3,3,"span",27),t.qZA(),t.TgZ(38,"div",28),t.YNc(39,dt,6,10,"span",29),t.qZA()()()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.userInfo),t.xp6(2),t.hij(" ",n.util.translate("Orders")," "),t.xp6(2),t.Q6J("ngIf",null==n.orders?null:n.orders.length),t.xp6(3),t.hij(" ",n.util.translate("Deliver to")," "),t.xp6(2),t.Oqu(n.orderAt),t.xp6(1),t.Q6J("ngIf","home"==n.orderAt),t.xp6(2),t.hij(" ",n.util.translate("Basic Details")," "),t.xp6(3),t.hij(" ",n.util.translate("Order ID")," "),t.xp6(2),t.Oqu(n.id),t.xp6(3),t.hij(" ",n.util.translate("Payment Method")," "),t.xp6(2),t.AsE(" ",n.payMethod," (",n.payName,") "),t.xp6(3),t.hij(" ",n.util.translate("Delivery On")," "),t.xp6(2),t.hij(" ",n.datetime," "),t.xp6(1),t.Q6J("ngIf",n.userInfo&&n.userInfo.mobile),t.xp6(1),t.Q6J("ngIf",n.userInfo&&n.userInfo.mobile),t.xp6(1),t.Q6J("ngIf",n.userInfo&&n.userInfo.email),t.xp6(1),t.Q6J("ngIf",n.userInfo&&n.userInfo.email),t.xp6(2),t.hij(" ",n.util.translate("Order Tracking")," "),t.xp6(3),t.Q6J("ngForOf",n.orderDetail),t.xp6(2),t.Q6J("ngForOf",n.orderDetail)}}function _t(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",57)(1,"select",58),t.NdJ("ngModelChange",function(i){t.CHM(n);const a=t.oxw(2);return t.KtG(a.changeStatusOrder=i)}),t.TgZ(2,"option",59),t._uU(3),t.qZA(),t.TgZ(4,"option",60),t._uU(5),t.qZA()(),t.TgZ(6,"button",61),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(2);return t.KtG(i.changeOrderStatus())}),t._uU(7),t.qZA()()}if(2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngModel",n.changeStatusOrder),t.xp6(2),t.hij(" ",n.util.translate("Refund"),""),t.xp6(2),t.hij(" ",n.util.translate("Refund From Merchant & Reject Order"),""),t.xp6(2),t.hij("",n.util.translate("Update Status")," ")}}function pt(e,s){if(1&e&&(t.TgZ(0,"div",55),t.YNc(1,_t,8,4,"div",56),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf","cod"!=n.payName)}}const gt=[{path:"",component:(()=>{class e{constructor(n,o,i,a){this.route=n,this.navCtrl=o,this.util=i,this.api=a,this.orderDetail=[],this.orders=[],this.drivers=[],this.dummyDrivers=[],this.assignee=[],this.assigneeDriver=[],this.orderStatus=[],this.statusText="",this.orderTax=0,this.totalStores=0,this.orderTotal=0,this.orderDiscount=0,this.orderDeliveryCharge=0,this.orderWalletDiscount=0,this.orderTaxCharge=0,this.orderGrandTotal=0,this.selected_driver="",this.payName="",this.route.queryParams.subscribe(c=>{console.log(c),c&&c.id?(this.id=c.id,this.loaded=!1,this.getOrder(),this.statusText=this.util.translate(" by administrator")):this.navCtrl.back()})}degreesToRadians(n){return n*Math.PI/180}distanceInKmBetweenEarthCoordinates(n,o,i,a){console.log(n,o,i,a);const _=this.degreesToRadians(i-n),u=this.degreesToRadians(a-o);n=this.degreesToRadians(n),i=this.degreesToRadians(i);const r=Math.sin(_/2)*Math.sin(_/2)+Math.sin(u/2)*Math.sin(u/2)*Math.cos(n)*Math.cos(i);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371}getOrder(){this.api.post_private("v1/orders/getByIdAdmin",{id:this.id}).then(o=>{if(console.log(o),this.loaded=!0,o&&o.status&&200==o.status&&o.data){const i=o.data;console.log(i),this.orderDetail=JSON.parse(i.notes);const a=JSON.parse(i.orders);console.log(a);const c=[...new Set(a.map(r=>r.store_id))];this.totalStores=c.length,this.orders=a,console.log("orde->>>",this.orders);let _=0;this.orders.forEach(r=>{let d=0;r.variations&&""!==r.variations&&"string"==typeof r.variations&&(console.log("strings",r.id),r.variations=JSON.parse(r.variations),console.log(r.variant),null==r.variant&&(r.variant=0)),d+=r&&0==r.discount?1==r.size?r.variations[0].items[r.variant].discount&&0!==r.variations[0].items[r.variant].discount?parseFloat(r.variations[0].items[r.variant].discount)*r.quantity:parseFloat(r.variations[0].items[r.variant].price)*r.quantity:parseFloat(r.original_price)*r.quantity:1==r.size?r.variations[0].items[r.variant].discount&&0!==r.variations[0].items[r.variant].discount?parseFloat(r.variations[0].items[r.variant].discount)*r.quantity:parseFloat(r.variations[0].items[r.variant].price)*r.quantity:parseFloat(r.sell_price)*r.quantity,console.log("PRICEEE--\x3e",d),console.log(_,d),_+=d}),console.log("==>",_),this.orderTotal=_,this.grandTotal=_.toFixed(2);const u=JSON.parse(i.status);if(console.log("------------------",u),this.orderStatus=u,this.datetime=x(i.date_time).format("dddd, MMMM Do YYYY"),this.payMethod="cod"==i.paid_method?"COD":"PAID",this.payName=i.paid_method,this.paymentRef=i.pay_key,this.orderAt=i.order_to,this.tax=i.tax,this.driverId=i.driver_id,i.discount>0&&(this.orderDiscount=(i.discount/this.totalStores).toFixed(2)),1==i.wallet_used&&(this.orderWalletDiscount=(i.wallet_price/this.totalStores).toFixed(2)),console.log("wallet discount",this.orderWalletDiscount),this.userInfo=o.user,"home"==this.orderAt){const r=JSON.parse(i.address);if(console.log("---address",r),r&&r.address&&(this.userLat=r.lat,this.userLng=r.lng,this.address=r.landmark+" "+r.house+" "+r.address+" "+r.pincode),i.driver_id&&""!==i.driver_id){const d=i.driver_id.split(",");this.assigneeDriver=d}console.log("----",this.assignee),console.log("----",this.assigneeDriver)}console.log("total stores",this.totalStores),console.log("order total",this.orderTotal),console.log("order discount",this.orderDiscount),console.log("order delivery charge",this.orderDeliveryCharge),console.log("order wallet",this.orderWalletDiscount),console.log("order tax",this.orderTaxCharge),console.log("order grandtotoal",this.orderGrandTotal)}else this.util.apiErrorHandler(o)},o=>{console.log(o),this.loaded=!0,this.util.apiErrorHandler(o)})}ngOnInit(){}back(){this.navCtrl.back()}call(){this.userInfo.mobile?window.open("tel:"+this.userInfo.mobile,"_system"):this.util.error(this.util.translate("Number not found"))}email(){this.userInfo.email?window.open("mailto:"+this.userInfo.email,"_system"):this.util.error(this.util.translate("Email not found"))}printOrder(){window.open(this.api.baseUrl+"v1/orders/printInvoice?id="+this.id+"&token="+localStorage.getItem("token"),"_system")}selectDriver(n){console.log(n),this.selected_driver=n.id}getTotalBilling(){const n=parseFloat(this.orderTotal)+parseFloat(this.orderTaxCharge)+parseFloat(this.orderDeliveryCharge),o=parseFloat(this.orderDiscount)+parseFloat(this.orderWalletDiscount);return n-o>0?n-o:0}sendNotification(){if(this.userInfo&&this.userInfo.fcm_token){const n={title:this.util.translate("Order refunded"),message:this.util.translate("Your order is rejected by store your refund amount will be credited within 2-3 bussiness days"),id:this.userInfo.fcm_token};this.api.post_private("v1/notification/sendNotification",n).then(o=>{console.log(o)},o=>{console.log(o)}).catch(o=>{console.log(o)})}}refundStripe(){console.log("refund stripe"),console.log(this.paymentRef);const n=JSON.parse(this.paymentRef);if(console.log("ref=>",n),n&&n.id){const o={charge_id:n.id};this.util.show(),this.api.post_private("v1/payments/refundStripePayments",o).then(i=>{console.log(i),i&&i.status&&200==i.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(i))},i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)}).catch(i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)})}}refundPayPal(){console.log("refund paypal"),console.log(this.paymentRef);const n=JSON.parse(this.paymentRef);let o;console.log("ref=>",n),n&&n.key?o=n.key:n&&n.intent&&"CAPTURE"==n.intent&&(o=n.purchase_units[0].payments.captures[0].id),console.log("transactional id",o);const i={ref:o,amount:this.grandTotal};console.log("param",i),this.util.show(),this.api.post_private("v1/payments/payPalRefund",i).then(a=>{console.log(a),a&&a.status&&200==a.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(a))},a=>{console.log(a),this.util.hide(),this.util.apiErrorHandler(a)}).catch(a=>{console.log(a),this.util.hide(),this.util.apiErrorHandler(a)})}refundPayTM(){console.log("refund paytm"),console.log(this.paymentRef);const n=JSON.parse(this.paymentRef);let o,i;if(console.log("ref=>",n),n&&n.key&&n.txtId){o=n.key,i=n.txtId;const a={id:o,txt_id:i,amount:this.grandTotal};this.util.show(),this.api.post_private("v1/payments/paytmRefund",a).then(c=>{console.log(c),c&&c.status&&200==c.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(c))},c=>{console.log(c),this.util.hide(),this.util.apiErrorHandler(c)}).catch(c=>{console.log(c),this.util.hide(),this.util.apiErrorHandler(c)})}}refundRazorPay(){console.log("refund razorpay"),console.log(this.paymentRef);const n=JSON.parse(this.paymentRef);if(console.log("ref=>",n),n&&n.id){const o={id:n.id};this.util.show(),this.api.post_private("v1/payments/razorPayRefund",o).then(i=>{console.log(i),i&&i.status&&200==i.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(i))},i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)}).catch(i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)})}}refundInstaMOJO(){let n;if(console.log("refund instamojo"),console.log(this.paymentRef),(i=>{try{return JSON.parse(i),!0}catch{return!1}})(this.paymentRef)){const i=JSON.parse(this.paymentRef);console.log("ref=>",i),n=i.payment_id}else n=this.paymentRef;console.log("key",n);const o={id:n};this.util.show(),this.api.post_private("v1/payments/instaMOJORefund",o).then(i=>{console.log(i),i&&i.status&&200==i.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(i))},i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)}).catch(i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)})}refundPayStack(){console.log("refund paystack");const n={id:this.paymentRef};this.util.show(),this.api.post_private("v1/payments/refundPayStack",n).then(o=>{console.log(o),o&&o.status&&200==o.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(o))},o=>{console.log(o),this.util.hide(),this.util.apiErrorHandler(o)}).catch(o=>{console.log(o),this.util.hide(),this.util.apiErrorHandler(o)})}refundFlutterwave(){console.log("refund flutterwave"),console.log(this.paymentRef);const n=JSON.parse(this.paymentRef);let o;console.log("ref=>",n),n&&n.orderId?o=n.orderId:n&&n.transaction_id&&(o=n.transaction_id),console.log("transactional id",o);const i={ref:o,amount:this.grandTotal};console.log("param",i),this.util.show(),this.api.post_private("v1/payments/refundFlutterwave",i).then(a=>{console.log(a),a&&a.status&&200==a.status?this.refundOrder():(this.util.hide(),this.util.apiErrorHandler(a))},a=>{console.log(a),this.util.hide(),this.util.apiErrorHandler(a)}).catch(a=>{console.log(a),this.util.hide(),this.util.apiErrorHandler(a)})}refundPaykun(){console.log("refund paykun")}changeOrderStatus(){console.log(this.changeStatusOrder),console.log("stauts",this.orderStatus),console.log("paid with",this.payName),"refund"==this.changeStatusOrder?(console.log("refund with API"),"stripe"==this.payName?this.refundStripe():"paypal"==this.payName?this.refundPayPal():"paytm"==this.payName?this.refundPayTM():"razorpay"==this.payName?this.refundRazorPay():"instamojo"==this.payName?this.refundInstaMOJO():"paystack"==this.payName?this.refundPayStack():"flutterwave"==this.payName?this.refundFlutterwave():"9"==this.payName&&this.refundPaykun()):(console.log("refund with merchant"),this.refundOrder())}refundOrder(){this.orderStatus.forEach(i=>{i.status="refund"});const n={status:1,value:"Order refunded "+this.statusText,time:x().format("lll")};this.orderDetail.push(n),this.util.show();const o={id:this.id,notes:JSON.stringify(this.orderDetail),status:JSON.stringify(this.orderStatus),order_status:"refund"};this.api.post_private("v1/orders/updateStatusAdmin",o).then(i=>{console.log("order",i),this.util.hide(),i&&200==i.status?(this.sendNotification(),this.back()):this.util.apiErrorHandler(i)},i=>{console.log(i),this.util.hide(),this.util.apiErrorHandler(i)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.gz),t.Y36(g.Ye),t.Y36(m.f),t.Y36(O.s))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-order-details"]],decls:12,vars:5,consts:[["type","ball-scale-multiple"],[1,"animated","fadeIn"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],["class","card-header-actions",4,"ngIf"],[1,"card-body"],["style","display: flex;flex-direction: column;justify-content: center;align-items: center;",4,"ngIf"],["class","main_content_div",4,"ngIf"],["class","card-footer",4,"ngIf"],[1,"card-header-actions"],["type","link",1,"btn","btn-primary",3,"click"],[2,"display","flex","flex-direction","column","justify-content","center","align-items","center"],[1,"loader"],[1,"main_content_div"],["class","card_div",4,"ngIf"],[1,"titles"],[1,"desc_div"],["class","border_bottom",4,"ngIf"],[1,"flex_div"],[1,"values"],["class","flex_div",4,"ngIf"],["class","hr_line_div",4,"ngIf"],["class","card_div2",4,"ngIf"],[1,"tracking_div"],[1,"left"],["style","display: flex; flex-direction: column; align-items: center;",4,"ngFor","ngForOf"],[1,"right"],[4,"ngFor","ngForOf"],[1,"card_div"],[1,"resto_detail"],[1,"back_image",3,"ngStyle"],[2,"margin-left","10px"],[1,"res_name"],[1,"res_location"],[1,"border_bottom"],["class","items",4,"ngFor","ngForOf"],[1,"items-billing"],[4,"ngIf"],[2,"text-transform","uppercase","color","red"],["style","text-transform: uppercase;color: red;",4,"ngIf"],[1,"items"],[1,"fa","fa-location-arrow","fa-lg"],[1,"hr_line_div"],[1,"card_div2"],[1,"personal_detail"],[2,"display","flex"],[1,"fa","fa-phone","fa-lg"],[1,"fa","fa-envelope-open","fa-lg"],[2,"display","flex","flex-direction","column","align-items","center"],[1,"line_div"],["class","fa fa-check-circle fa-lg",4,"ngIf"],[1,"fa","fa-check-circle","fa-lg"],[1,"round_div_gray"],[1,"card-footer"],["class","status_div",4,"ngIf"],[1,"status_div"],["id","ccyear",1,"form-control",3,"ngModel","ngModelChange"],["value","refund"],["value","refunded"],["type","button",1,"btn","btn-sm","btn-block","btn-success","active",2,"margin","0px",3,"click"]],template:function(n,o){1&n&&(t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._uU(6),t.YNc(7,C,3,1,"div",6),t.qZA(),t.TgZ(8,"div",7),t.YNc(9,y,3,1,"div",8),t.YNc(10,lt,40,21,"div",9),t.qZA(),t.YNc(11,pt,2,1,"div",10),t.qZA()()()()),2&n&&(t.xp6(6),t.hij(" ",o.util.translate("Orders Details")," "),t.xp6(1),t.Q6J("ngIf",o.loaded),t.xp6(2),t.Q6J("ngIf",!o.loaded),t.xp6(1),t.Q6J("ngIf",o.loaded),t.xp6(1),t.Q6J("ngIf",o.loaded))},dependencies:[g.sg,g.O5,g.PC,p.YN,p.Kr,p.EJ,p.JJ,p.On,v.Ro],styles:['@charset "UTF-8";.main_content_div[_ngcontent-%COMP%]{width:100%;padding:16px}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]{padding:20px}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]   .resto_detail[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;position:relative}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]   .resto_detail[_ngcontent-%COMP%]   .back_image[_ngcontent-%COMP%]{height:50px;width:50px;background-position:center;background-size:cover;background-repeat:no-repeat;border-radius:100%}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]   .resto_detail[_ngcontent-%COMP%]   .res_name[_ngcontent-%COMP%]{font-weight:700;font-size:14px}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]   .resto_detail[_ngcontent-%COMP%]   .res_location[_ngcontent-%COMP%]{color:gray;font-size:14px}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]   .resto_detail[_ngcontent-%COMP%]   .order_id[_ngcontent-%COMP%]{position:absolute;right:5px}.main_content_div[_ngcontent-%COMP%]   .card_div[_ngcontent-%COMP%]   .resto_detail[_ngcontent-%COMP%]   .order_id[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:right}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]{padding:10px 20px}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .personal_detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;align-items:center}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .personal_detail[_ngcontent-%COMP%]   .res_name[_ngcontent-%COMP%]{font-weight:700;font-size:14px}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]   .head_gray[_ngcontent-%COMP%]{color:gray;font-size:13px;margin-top:10px}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]   .small_lbl[_ngcontent-%COMP%]{font-size:14px;font-weight:700}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]   .prize[_ngcontent-%COMP%]{position:absolute;right:35px;font-weight:700;color:#000}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]   .prize1[_ngcontent-%COMP%]{position:absolute;right:35px;font-weight:700;color:#000;font-size:16px;margin-top:10px}.main_content_div[_ngcontent-%COMP%]   .card_div2[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]   .small_lbl2[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin-top:10px}.main_content_div[_ngcontent-%COMP%]   .titles[_ngcontent-%COMP%]{font-size:15px;font-weight:700;margin:20px 0;border-bottom:1px solid lightgray;padding-bottom:10px}.main_content_div[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:block}.main_content_div[_ngcontent-%COMP%]   .desc_div[_ngcontent-%COMP%]{width:100%}.main_content_div[_ngcontent-%COMP%]   .desc_div[_ngcontent-%COMP%]   .border_bottom[_ngcontent-%COMP%]{padding-bottom:10px;width:100%}.main_content_div[_ngcontent-%COMP%]   .desc_div[_ngcontent-%COMP%]   .border_bottom[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{margin:0 0 10px;display:flex;flex-direction:row;justify-content:space-between;font-size:12px;font-weight:700;padding-bottom:5px;border-bottom:.5px dashed lightgray}.main_content_div[_ngcontent-%COMP%]   .desc_div[_ngcontent-%COMP%]   .border_bottom[_ngcontent-%COMP%]   .items-billing[_ngcontent-%COMP%]{margin:0 0 10px;display:flex;flex-direction:row;justify-content:space-between;font-size:12px;padding-bottom:5px;border-bottom:.5px dashed lightgray;font-weight:700}.main_content_div[_ngcontent-%COMP%]   .desc_div[_ngcontent-%COMP%]   .border_bottom[_ngcontent-%COMP%]   .items-billing[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.main_content_div[_ngcontent-%COMP%]   .desc_div[_ngcontent-%COMP%]   .border_bottom[_ngcontent-%COMP%]   .itemss[_ngcontent-%COMP%]{margin:0 0 5px;display:flex;flex-direction:row;justify-content:space-between;font-size:12px;font-weight:700}.main_content_div[_ngcontent-%COMP%]   .flex_div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;font-size:12px;padding-bottom:10px}.main_content_div[_ngcontent-%COMP%]   .flex_div[_ngcontent-%COMP%]   .values[_ngcontent-%COMP%]{font-weight:700;text-transform:capitalize}.main_content_div[_ngcontent-%COMP%]   .hr_line_div[_ngcontent-%COMP%]{margin-top:15px;width:100%;height:1px;background:lightgray}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]{margin-top:30px;display:flex;flex-direction:row}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:20%}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .line_div[_ngcontent-%COMP%]{height:40px;width:5px;border:1px solid #e8e8e8;background-color:gray}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .line_div_darkgray[_ngcontent-%COMP%]{height:40px;width:1px;border:1px solid #c8c7ce}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .round_div_gray[_ngcontent-%COMP%]{height:20px;width:20px;background-color:#e8e8e8;border-radius:50%;margin-left:-9px}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .round_div_darkgray[_ngcontent-%COMP%]{height:20px;width:20px;background-color:#c8c7ce;border-radius:50%;margin-left:-9px}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .round_div_red[_ngcontent-%COMP%]{height:20px;width:20px;background-color:green;border-radius:50%;margin-left:-9px}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;width:80%}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .line_div[_ngcontent-%COMP%]{height:45px;width:100%;display:flex;align-items:flex-end}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .round_div_gray[_ngcontent-%COMP%]{height:20px;width:100%;color:#c8c7ce}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .round_div_red[_ngcontent-%COMP%]{height:20px;width:100%;color:green}.main_content_div[_ngcontent-%COMP%]   .tracking_div[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .round_div_darkgray[_ngcontent-%COMP%]{height:20px;width:100%;color:gray}.btn_div[_ngcontent-%COMP%]{display:flex;justify-content:center}.btn_div[_ngcontent-%COMP%]   .reject[_ngcontent-%COMP%], .btn_div[_ngcontent-%COMP%]   .accept[_ngcontent-%COMP%]{background:green}.status_div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-left:20px;padding-right:20px;align-items:center}.green[_ngcontent-%COMP%], .red[_ngcontent-%COMP%]{display:block;text-align:center;color:green;font-weight:700}.loader[_ngcontent-%COMP%]{font-size:10px;margin:50px auto;text-indent:-9999em;width:11em;height:11em;border-radius:50%;background:gray;background:linear-gradient(to right,gray 10%,rgba(255,255,255,0) 42%);position:relative;animation:load3 1.4s infinite linear;transform:translateZ(0)}.loader[_ngcontent-%COMP%]:before{width:50%;height:50%;background:gray;border-radius:100% 0 0;position:absolute;top:0;left:0;content:""}.loader[_ngcontent-%COMP%]:after{background:white;width:75%;height:75%;border-radius:50%;content:"";margin:auto;position:absolute;top:0;left:0;bottom:0;right:0}@keyframes load3{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']}),e})()}];let ut=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(gt),f.Bz]}),e})();var ft=l(388);let ht=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.ez,ut,ft.zk.forRoot(),p.u5,v.ef]}),e})()}}]);